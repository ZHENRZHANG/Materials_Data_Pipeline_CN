# 从POSCAR等文件转化为MongoDB数据库文档
# 插入文档到 MongoDB
from turtledemo.penrose import start
import pandas as pd

from pymongo import MongoClient
import pprint
import os
import shutil
from collections import Counter
import json
from pprint import pprint
import json
import csv
import json

import json

# 读取配置文件
with open("config.json", "r") as f:
    config = json.load(f)["mongodb"]

client = MongoClient(config["uri"])
collection = client[config["db_name"]][config["collection_name"]]


# 2. 构造查询条件
entry_ids = ['ID-1010']
# entry_ids = ['ID-1465', 'ID-1466', 'ID-1467', 'ID-1468', 'ID-1469', 'ID-1470', 'ID-1471', 'ID-1472', 'ID-1473', 'ID-1474', 'ID-1475', 'ID-1476', 'ID-1477', 'ID-1478', 'ID-1479', 'ID-1480', 'ID-1481', 'ID-1482', 'ID-1483', 'ID-1484', 'ID-1485', 'ID-1486', 'ID-1487', 'ID-1488', 'ID-1489', 'ID-1490', 'ID-1491', 'ID-1492', 'ID-1493', 'ID-1494', 'ID-1495', 'ID-1496', 'ID-1497', 'ID-1498', 'ID-1499', 'ID-1500', 'ID-1501', 'ID-1502', 'ID-1503', 'ID-1504', 'ID-1505', 'ID-1506', 'ID-1507', 'ID-1508', 'ID-1509', 'ID-1510', 'ID-1511', 'ID-1512', 'ID-1513', 'ID-1514', 'ID-1515', 'ID-1516', 'ID-1517', 'ID-1518', 'ID-1519', 'ID-1520', 'ID-1521', 'ID-1522', 'ID-1523', 'ID-1524', 'ID-1525', 'ID-1526', 'ID-1527', 'ID-1528', 'ID-1529', 'ID-1530', 'ID-1531', 'ID-1532', 'ID-1533', 'ID-1534', 'ID-1535', 'ID-1536', 'ID-1537', 'ID-1538', 'ID-1539', 'ID-1540', 'ID-1541', 'ID-1542', 'ID-1543', 'ID-1544', 'ID-1545', 'ID-1546', 'ID-1547', 'ID-1548', 'ID-1549', 'ID-1550', 'ID-1551', 'ID-1552', 'ID-1553', 'ID-1554', 'ID-1555', 'ID-1556', 'ID-1557', 'ID-1558', 'ID-1559', 'ID-1560', 'ID-1561', 'ID-1562', 'ID-1563', 'ID-1564', 'ID-1565', 'ID-1566', 'ID-1567', 'ID-1568', 'ID-1569', 'ID-1570', 'ID-1571', 'ID-1572', 'ID-1573', 'ID-1574', 'ID-1575', 'ID-1576', 'ID-1577', 'ID-1578', 'ID-1579', 'ID-1580', 'ID-1581', 'ID-1582', 'ID-1583', 'ID-1584', 'ID-1585', 'ID-1586', 'ID-1587', 'ID-1588', 'ID-1589', 'ID-1590', 'ID-1591', 'ID-1592', 'ID-1593', 'ID-1594', 'ID-1595', 'ID-1596', 'ID-1597', 'ID-1598', 'ID-1599', 'ID-1600', 'ID-1601', 'ID-1602', 'ID-1603', 'ID-1604', 'ID-1605', 'ID-1606', 'ID-1607', 'ID-1608', 'ID-1609', 'ID-1610', 'ID-1611', 'ID-1612', 'ID-1613', 'ID-1614', 'ID-1615', 'ID-1616', 'ID-1617', 'ID-1618', 'ID-1619', 'ID-1620', 'ID-1621', 'ID-1622', 'ID-1623', 'ID-1624', 'ID-1625', 'ID-1626', 'ID-1627', 'ID-1628', 'ID-1629', 'ID-1630', 'ID-1631', 'ID-1632', 'ID-1633', 'ID-1634', 'ID-1635', 'ID-1636', 'ID-1637', 'ID-1638', 'ID-1639', 'ID-1640', 'ID-1641', 'ID-1642', 'ID-1643', 'ID-1644', 'ID-1645', 'ID-1646', 'ID-1647', 'ID-1648', 'ID-1649', 'ID-1650', 'ID-1651', 'ID-1652', 'ID-1653', 'ID-1654', 'ID-1655', 'ID-1656', 'ID-1657', 'ID-1658', 'ID-1659', 'ID-1660', 'ID-1661', 'ID-1662', 'ID-1771', 'ID-1772', 'ID-1773', 'ID-1774', 'ID-1775', 'ID-1776', 'ID-1777', 'ID-1778', 'ID-1779', 'ID-1780', 'ID-1781', 'ID-1782', 'ID-1783', 'ID-1784', 'ID-1785', 'ID-1786', 'ID-1787', 'ID-1788', 'ID-1789', 'ID-1790', 'ID-1791', 'ID-1792', 'ID-1793', 'ID-1794', 'ID-1795', 'ID-1796', 'ID-1797', 'ID-1798', 'ID-1799', 'ID-1800', 'ID-1801', 'ID-1802', 'ID-1803', 'ID-1804', 'ID-1805', 'ID-1806', 'ID-1807', 'ID-1808', 'ID-1809', 'ID-1810', 'ID-1811', 'ID-1812', 'ID-1813', 'ID-1814', 'ID-1815', 'ID-1816', 'ID-1817', 'ID-1818', 'ID-1819', 'ID-1820', 'ID-1821', 'ID-1822', 'ID-1823', 'ID-1824', 'ID-1825', 'ID-1826', 'ID-1827', 'ID-1828', 'ID-1829', 'ID-1830', 'ID-1831', 'ID-1832', 'ID-1833', 'ID-1834', 'ID-1835', 'ID-1836', 'ID-1837', 'ID-1838', 'ID-1839', 'ID-1840', 'ID-1841', 'ID-1842', 'ID-1843', 'ID-1844', 'ID-1845', 'ID-1846', 'ID-1847', 'ID-1848', 'ID-1849', 'ID-1850', 'ID-1851', 'ID-1852', 'ID-1853', 'ID-1854', 'ID-1855', 'ID-1856', 'ID-1857', 'ID-1858', 'ID-1859', 'ID-1860', 'ID-1861', 'ID-1862', 'ID-1863', 'ID-1864', 'ID-1865', 'ID-1866', 'ID-1867', 'ID-1868', 'ID-1869', 'ID-1870', 'ID-1871', 'ID-1872', 'ID-1873', 'ID-1874', 'ID-1875', 'ID-1876', 'ID-1877', 'ID-1878', 'ID-1879', 'ID-1880', 'ID-1881', 'ID-1882', 'ID-1883', 'ID-1884', 'ID-1885', 'ID-1886', 'ID-1887', 'ID-1888', 'ID-1889', 'ID-1890', 'ID-1891', 'ID-1892', 'ID-1893', 'ID-1894', 'ID-1895', 'ID-1896', 'ID-1897', 'ID-1898', 'ID-1899', 'ID-1900', 'ID-1901', 'ID-1902', 'ID-1903', 'ID-1904', 'ID-1905', 'ID-1906', 'ID-1907', 'ID-1908', 'ID-1909', 'ID-1910', 'ID-1911', 'ID-1912', 'ID-1913', 'ID-1914', 'ID-1915', 'ID-1916', 'ID-1917', 'ID-1918', 'ID-1919', 'ID-1920', 'ID-1921', 'ID-1922', 'ID-1923', 'ID-1924', 'ID-1925', 'ID-1926', 'ID-1927', 'ID-1928', 'ID-1929', 'ID-1930', 'ID-1931', 'ID-1932', 'ID-1933', 'ID-1934', 'ID-1935', 'ID-1936', 'ID-1937', 'ID-1938', 'ID-1939', 'ID-1940', 'ID-1941', 'ID-1942', 'ID-1943', 'ID-1944', 'ID-1945', 'ID-1946', 'ID-1947', 'ID-1948', 'ID-1949', 'ID-1950', 'ID-1951', 'ID-1952', 'ID-1953', 'ID-1954', 'ID-1955', 'ID-1956', 'ID-1957', 'ID-1958', 'ID-1959', 'ID-1960', 'ID-1961', 'ID-1962', 'ID-1963', 'ID-1964', 'ID-1965', 'ID-1966', 'ID-1967', 'ID-1968', 'ID-1969', 'ID-1970', 'ID-1971', 'ID-1972', 'ID-1973', 'ID-1974', 'ID-1975', 'ID-1976', 'ID-1977', 'ID-1978', 'ID-1979', 'ID-1980', 'ID-1981', 'ID-1982', 'ID-1983', 'ID-1984', 'ID-1985', 'ID-1986', 'ID-1987', 'ID-1988', 'ID-1989', 'ID-1990', 'ID-1991', 'ID-1992', 'ID-1993', 'ID-1994', 'ID-1995', 'ID-1996', 'ID-1997', 'ID-1998', 'ID-1999', 'ID-2000', 'ID-2001', 'ID-2002', 'ID-2003', 'ID-2004', 'ID-2005', 'ID-2006', 'ID-2007', 'ID-2008', 'ID-2009', 'ID-2010', 'ID-2011', 'ID-2012', 'ID-2013', 'ID-2014', 'ID-2015', 'ID-2016', 'ID-2017', 'ID-2018', 'ID-2019', 'ID-2020', 'ID-2021', 'ID-2022', 'ID-2023', 'ID-2024', 'ID-2025', 'ID-2026', 'ID-2027', 'ID-2028', 'ID-2029', 'ID-2030', 'ID-2031', 'ID-2032', 'ID-2033', 'ID-2034', 'ID-2035', 'ID-2036', 'ID-2037', 'ID-2038', 'ID-2039', 'ID-2040', 'ID-2041', 'ID-2042', 'ID-2043', 'ID-2044', 'ID-2045', 'ID-2046', 'ID-2047', 'ID-2048', 'ID-2049', 'ID-2050', 'ID-2051', 'ID-2408', 'ID-2409', 'ID-2410', 'ID-2411', 'ID-2412', 'ID-2413', 'ID-2414', 'ID-2415', 'ID-2416', 'ID-2417', 'ID-2418', 'ID-2419', 'ID-2420', 'ID-2421', 'ID-2422', 'ID-2423', 'ID-2424', 'ID-2425', 'ID-2426', 'ID-2427', 'ID-2428', 'ID-2429', 'ID-2430', 'ID-2431', 'ID-2432', 'ID-2433', 'ID-2434', 'ID-2435', 'ID-2436', 'ID-2437', 'ID-2438', 'ID-2439', 'ID-2440', 'ID-2441', 'ID-2442', 'ID-2443', 'ID-2444', 'ID-2445', 'ID-2446', 'ID-2447', 'ID-2448', 'ID-2449', 'ID-2450', 'ID-2451', 'ID-2452', 'ID-2453', 'ID-2454', 'ID-2455', 'ID-2456', 'ID-2457', 'ID-2458', 'ID-2459', 'ID-2460', 'ID-2461', 'ID-2462', 'ID-2463', 'ID-2464', 'ID-2465', 'ID-2466', 'ID-2467', 'ID-2468', 'ID-2469', 'ID-2470', 'ID-2471', 'ID-2472', 'ID-2473', 'ID-2474', 'ID-2475', 'ID-2476', 'ID-2477', 'ID-2478', 'ID-2479', 'ID-2480', 'ID-2481', 'ID-2482', 'ID-2483', 'ID-2484', 'ID-2485', 'ID-2486', 'ID-2487', 'ID-2488', 'ID-2489', 'ID-2490', 'ID-2491', 'ID-2492', 'ID-2493', 'ID-2494', 'ID-2495', 'ID-2496', 'ID-2497', 'ID-2498', 'ID-2499', 'ID-2500', 'ID-2501', 'ID-2502', 'ID-2503', 'ID-2504', 'ID-2505', 'ID-2506', 'ID-2507', 'ID-2508', 'ID-2509', 'ID-2510', 'ID-2511', 'ID-2512', 'ID-2513', 'ID-2514', 'ID-2515', 'ID-2516', 'ID-2517', 'ID-2518', 'ID-2519', 'ID-2520', 'ID-2521', 'ID-2522', 'ID-2523', 'ID-2524', 'ID-2525', 'ID-2526', 'ID-2527', 'ID-2528', 'ID-2529', 'ID-2530', 'ID-2531', 'ID-2532', 'ID-2533', 'ID-2534', 'ID-2535', 'ID-2536', 'ID-2537', 'ID-2538', 'ID-2539', 'ID-2540', 'ID-2541', 'ID-2542', 'ID-2543', 'ID-2544', 'ID-2545', 'ID-2546', 'ID-2547', 'ID-2548', 'ID-2549', 'ID-2550', 'ID-2551', 'ID-2552', 'ID-2553', 'ID-2554', 'ID-2555', 'ID-2556', 'ID-2557', 'ID-2558', 'ID-2559', 'ID-2560', 'ID-2561', 'ID-2562', 'ID-2563', 'ID-2564', 'ID-2565', 'ID-2566', 'ID-2567', 'ID-2568', 'ID-2569', 'ID-2570', 'ID-2571', 'ID-2572', 'ID-2573', 'ID-2574', 'ID-2575', 'ID-2576', 'ID-2577', 'ID-2578', 'ID-2579', 'ID-2580', 'ID-2581', 'ID-2582', 'ID-2583', 'ID-2584', 'ID-2585', 'ID-2586', 'ID-1064', 'ID-1065', 'ID-1066', 'ID-1067', 'ID-1068', 'ID-1069', 'ID-1070', 'ID-1071', 'ID-1072', 'ID-1073', 'ID-1074', 'ID-1075', 'ID-1076', 'ID-1077', 'ID-1078', 'ID-1079', 'ID-1080', 'ID-1081', 'ID-1082', 'ID-1083', 'ID-1084', 'ID-1085', 'ID-1086', 'ID-1087', 'ID-1088', 'ID-1089', 'ID-1090', 'ID-1091', 'ID-1092', 'ID-1093', 'ID-1094', 'ID-1095', 'ID-1096', 'ID-1097', 'ID-1098', 'ID-1099', 'ID-1100', 'ID-1101', 'ID-1102', 'ID-1103', 'ID-1104', 'ID-1105', 'ID-1106', 'ID-1107', 'ID-1464']


# 3. 执行查询
query = {"entry_id": {"$in": entry_ids}}
docs = list(collection.find(query))

# # 转换函数：将 ObjectId 转为字符串
# def convert_oid(doc):
#     if "_id" in doc:
#         doc["_id"] = str(doc["_id"])
#     return doc
#
# # 应用转换
# converted_docs = [convert_oid(doc) for doc in docs]
#
# # 写入文件
# with open("output.json", "w", encoding="utf-8") as f:
#     json.dump(converted_docs, f, ensure_ascii=False, indent=2)

# 4. 打印结果
print(f"共找到 {len(docs)} 条记录：\n")
for doc in docs:
    pprint(doc)
    print("-" * 60)




